---
title: "MP2"
author: "Grace Rade, Carol Milton, Nikki Lin"
date: "2023-04-20"
---

```{r, include=F, warning=F, echo=F}
library(tidyverse)
library(rio)
library(asbio)
library(readr)
library(Stat2Data)
library(car)
```

```{r, include=F, warning=F, echo=F}
df <- import("CleanedData.csv")
df$condition <- as.factor(df$condition)
```

# Introduction

# Methodology

# Results

## Checking Anova Conditions

We begin with checking the conditions for Anova testing. We know that the response variable, how the much the participant likes Sam, is continuous while the factors, Sam's 'good' or 'bad' actions and Sam's age, are categorical, which satisfies the condition about the types of variables. We then check for constant variance.

### Constant Variance

```{r, warning=F, echo=F}
qplot(x=condition, y=opinion, data=df, ylab="Rating the Liking of Sam",
      xlab='Treatment', geom="boxplot") +
  theme(axis.title = element_text(size = 15))
```
```{r, echo=F}
leveneTest(opinion~condition, data=df)
```

```{r, echo=F}
df |>
  group_by(condition) |>
  summarise(Group_mean=mean(opinion), Sample_size=n(), Standard_dev=sd(opinion))
```

### Normality
```{r, echo=F, warning=F}
ggplot(df, aes(x=opinion, color=condition))+geom_density()
```
There are clear violations of normality for all four groups.

### Transformation

We now check to see if a transformation of the responses can help satisfy the condition of normality. First, we plot the mean and standard deviations for the response variable, liking of Sam, across the treatment groups.

```{r, echo=F, message=F}
summary_stats <- df |>
  group_by(condition) |>
  summarise(mean=log(mean(opinion)), sd=log(sd(opinion)))

ggplot(summary_stats, aes(x=mean, y=sd), ylab="Log(sd)", xlab="Log(mean)") +
  geom_point() +
  geom_smooth(method="lm", se=F)
```

Using the means and standard deviations, we create a linear model and look at the slope.

```{r, echo=F}
lin <- lm(sd~mean, data=summary_stats)
summary(lin)
```

The slope is -0.62 and so 1-slope is 1.62, thus, we can try to see if a reciprocals transformation can help.

```{r, echo=F}
df <- df |>
  mutate(recip_opinion = 1/opinion)
```

```{r, echo=F, warning=F}
ggplot(df, aes(x=recip_opinion, color=condition))+geom_density()
```
The distributions are still not normal so a reciprocals transformation did not help. Therefore, the condition for normality is violated. However, we will continue with Anova testing and then check the robustness of the model with the non-parametric test, the Kruskal Wallis test.

## Anova Testing
```{r, echo=F}
# will create anova model called liking.aov
```


## Kruskal Wallis Test

## Checking Residuals

We want to check the residuals to further evaluate our model.

```{r, echo=F, warning=F}
# resid <-  resid(liking.aov)
# 
# Model <- data.frame(Fitted = fitted(liking.aov), 
#                     Residuals = resid(liking.aov),
#                     Treatment = df$condition,
#                     Observed=df$opinion)
```

```{r, echo=F, warning=F}
# ggplot(Model, aes(x=Treatment, y=Residuals)) + geom_point()
```



```{r, echo=F, warning=F}
# ggplot(Model, aes(x=Residuals, color=Treatment))+geom_density()
```

# Conclusion
>>>>>>> d84fe0b2f541a5d211cb43f8bc663feefd7bb278

